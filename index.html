<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Changing the Subject of an Equation</title>

  <style>
    :root {
      --top-bar-bg: #34495e;
      --bottom-bar-bg: #2c3e50;
      --page-bg: #f7f4e9;

      --card-bg: #ffffff;
      --card-border: #1f7ed0;

      --text-main: #1f2933;
      --text-muted: #ecf0f1;

      --pill-blue: #3498db;
      --pill-green: #27ae60;
      --pill-red: #e74c3c;
      --pill-purple: #8e44ad;
      --pill-yellow: #f1c40f;

      --toolbar-icon-bg: #f1c40f;
      --toolbar-icon-border: #e0a708;

      --shadow-soft: 0 6px 18px rgba(0, 0, 0, 0.12);
      --radius-card: 18px;
      --radius-pill: 999px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--page-bg);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .top-bar {
      background: var(--top-bar-bg);
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 24px;
      font-size: 14px;
    }
    .top-left { display: flex; flex-direction: column; gap: 6px; }
    .meta-row { display: flex; align-items: baseline; gap: 6px; }
    .meta-label { font-weight: 600; opacity: 0.9; }
    .meta-value {
      border-bottom: 2px solid rgba(236, 240, 241, 0.7);
      padding-bottom: 2px;
      font-weight: 500;
    }
    .top-right { display: flex; align-items: center; gap: 18px; font-weight: 500; }
    .page-info { white-space: nowrap; }

    .slide-select-wrapper { position: relative; }
    .slide-select {
      padding: 6px 28px 6px 10px;
      border-radius: 6px;
      border: none;
      font-size: 13px;
      font-weight: 500;
      outline: none;
      background: #ffffff;
      color: #333;
      appearance: none;
    }
    .slide-select-wrapper::after {
      content: "‚ñæ";
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 10px;
      pointer-events: none;
      color: #555;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 40px 24px 40px;
      gap: 18px;
      position: relative;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-card);
      border: 3px solid var(--card-border);
      box-shadow: var(--shadow-soft);
      max-width: 900px;
      width: 100%;
      padding: 26px 34px 30px;
    }

    .card h1 {
      font-size: 30px;
      margin-bottom: 12px;
      font-weight: 800;
      color: #2c3e50;
    }

    .card p { font-size: 18px; line-height: 1.6; }
    .example-card p { font-size: 16px; line-height: 1.55; }

    .bullets {
      margin-top: 8px;
      padding-left: 18px;
      font-size: 18px;
      line-height: 1.6;
    }
    .bullets li { margin: 6px 0; }

    .math { font-size: 52px; line-height: 1.25; }
    .math i { font-style: italic; }
    .math sup { font-size: 60%; vertical-align: super; }

    .equation-line {
      display: flex;
      align-items: baseline;
      gap: 14px;
      margin: 22px 0;
    }

    .q-label {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      font-size: 22px;
      font-weight: 800;
      color: #2c3e50;
      width: 44px;
      text-align: right;
      flex: 0 0 auto;
    }

    .questions-grid {
      max-width: 900px;
      width: 100%;
      padding: 0 34px;
      margin-top: 14px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      column-gap: 120px;
      row-gap: 160px;
      justify-items: start;
    }

    .q-block {
      font-family: "Times New Roman", Times, serif;
      font-size: 52px;
      line-height: 1.25;
      display: flex;
      align-items: baseline;
      gap: 14px;
    }

    .questions-rows {
      max-width: 900px;
      width: 100%;
      padding: 0 34px;
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      gap: 70px;
    }

    .q-row {
      display: flex;
      align-items: baseline;
      gap: 14px;
    }

    .questions-cols {
      max-width: 900px;
      width: 100%;
      padding: 0 34px;
      margin-top: 14px;
      display: grid;
      column-gap: 120px;
      row-gap: 70px;
      justify-items: start;
    }

    .q-col {
      display: flex;
      align-items: baseline;
      gap: 14px;
    }

    .q-col.placeholder { opacity: 0; pointer-events: none; }

    .q-content {
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-width: 0;
    }

    .q-main {
      font-family: "Times New Roman", Times, serif;
      font-size: 52px;
      line-height: 1.25;
    }

    .q-sub {
      font-family: "Times New Roman", Times, serif;
      font-size: 34px;
      line-height: 1.25;
    }

    .q-row.placeholder { opacity: 0; pointer-events: none; }

    .review-slide {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      margin-top: 6px;
    }

    .review-title {
      border: 3px solid #f59e0b;
      background: #fff7ed;
      color: #c2410c;
      font-size: 26px;
      font-weight: 900;
      padding: 14px 18px;
      border-radius: 12px;
      box-shadow: var(--shadow-soft);
      width: 100%;
      max-width: 900px;
    }

    .review-box {
      border: 3px solid #3b82f6;
      background: #ffffff;
      padding: 16px 18px;
      border-radius: 12px;
      font-size: 18px;
      line-height: 1.5;
      box-shadow: var(--shadow-soft);
      width: 100%;
      max-width: 900px;
    }

    .review-box strong { font-weight: 900; }

    .review-example {
      margin-top: 8px;
      text-align: center;
      font-family: "Times New Roman", Times, serif;
      font-size: 28px;
      font-weight: 700;
    }

    .apply-task {
      border: 3px solid #16a34a;
      background: #ecfdf5;
      padding: 20px 18px;
      border-radius: 14px;
      box-shadow: var(--shadow-soft);
      width: 100%;
      max-width: 900px;
      text-align: center;
    }
    .apply-task h2 {
      color: #166534;
      font-size: 32px;
      margin-bottom: 8px;
      font-weight: 900;
    }
    .apply-task p {
      font-size: 20px;
      color: #14532d;
      font-weight: 700;
    }

    .timer-widget {
      position: absolute;
      left: 24px;
      top: 110px;
      width: 260px;
      background: #111;
      color: #fff;
      border-radius: 14px;
      padding: 18px 16px 16px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.18);
      border: 3px solid #0ea5e9;
      user-select: none;
      z-index: 5;
      cursor: grab;
    }
    .timer-widget:active { cursor: grabbing; }

    .timer-display {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 48px;
      letter-spacing: 2px;
      text-align: center;
      margin-bottom: 12px;
    }
    .timer-controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 12px;
    }
    .timer-btn {
      background: #2d9cdb;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 8px 12px;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }
    .timer-btn:active { transform: translateY(1px); }
    .timer-inputs {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-weight: 700;
    }
    .timer-inputs label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
    }
    .timer-inputs input {
      width: 56px;
      padding: 6px 8px;
      border-radius: 8px;
      border: 2px solid rgba(255,255,255,0.25);
      outline: none;
      font-weight: 800;
      text-align: center;
      background: #fff;
      color: #111;
    }

    #drawCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .hidden { display: none; }

    .toolbar {
      background: var(--bottom-bar-bg);
      color: var(--text-muted);
      padding: 10px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      flex-wrap: wrap;
    }
    .toolbar-left, .toolbar-right {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .tool-button, .pill-button {
      border: none;
      outline: none;
      cursor: pointer;
      font: inherit;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
    }
    .tool-button {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: #1f4b6f;
      color: #ecf0f1;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
    }
    .tool-button.square-active {
      width: 40px;
      border-radius: 12px;
      background: var(--toolbar-icon-bg);
      color: #2c3e50;
      border: 2px solid var(--toolbar-icon-border);
      font-size: 18px;
    }
    .tool-button.circle { border-radius: 50%; }
    .tool-button.disabled { opacity: 0.4; cursor: default; pointer-events: none; }
    .tool-button.active { box-shadow: 0 0 0 2px #f1c40f, 0 2px 6px rgba(0,0,0,0.35); }

    .pill-button {
      padding: 7px 14px;
      border-radius: var(--radius-pill);
      font-weight: 700;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
    }
    .pill-blue { background: var(--pill-blue); color: #ecf0f1; }
    .pill-red { background: var(--pill-red); color: #ffffff; }
    .pill-purple { background: var(--pill-purple); color: #ecf0f1; }
    .pill-green { background: var(--pill-green); color: #ecf0f1; }
    .toolbar-spacer { flex: 1; }

    .wrap-ans{
      display: inline-block;
      max-width: 540px;
      vertical-align: top;
    }

    @media (max-width: 900px) {
      .timer-widget {
        position: static;
        width: 100%;
        max-width: 360px;
        margin-bottom: 14px;
        cursor: default;
      }
      .questions-grid {
        grid-template-columns: 1fr;
        row-gap: 70px;
        column-gap: 0;
      }
      .math, .q-block { font-size: 42px; }
      .q-main { font-size: 42px; }
      .q-sub { font-size: 30px; }
    }

    .slide16-zoom {
      transform: scale(1);
      transform-origin: top center;
      width: 125%;
      margin-bottom: -240px;
    }

    .slide7-zoom {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      gap: 18px;
      transform: scale(0.9);
      transform-origin: top center;
      margin-bottom: -240px;
    }
  </style>

  <!-- MathJax -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']],
        packages: { '[+]': ['html'] } /* enables \class{} */
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>

<body>
  <header class="top-bar">
    <div class="top-left">
      <div class="meta-row">
        <span class="meta-label">Date:</span>
        <span class="meta-value">08/01/2026</span>
      </div>
      <div class="meta-row">
        <span class="meta-label">Title:</span>
        <span class="meta-value">Changing the Subject of an Equation</span>
      </div>
    </div>

    <div class="top-right">
      <span class="page-info" id="pageInfo">Slide 1 of 15</span>
      <div class="slide-select-wrapper">
        <select class="slide-select" id="slideSelect"></select>
      </div>
    </div>
  </header>

  <main class="content">
    <div id="timerWidget" class="timer-widget hidden">
      <div id="timerDisplay" class="timer-display">01:00</div>
      <div class="timer-controls">
        <button id="timerStart" class="timer-btn">Start</button>
        <button id="timerPause" class="timer-btn">Pause</button>
        <button id="timerReset" class="timer-btn">Reset</button>
      </div>
      <div class="timer-inputs">
        <label>Min: <input id="timerMin" type="number" min="0" max="999" value="1"></label>
        <label>Sec: <input id="timerSec" type="number" min="0" max="59" value="0"></label>
      </div>
    </div>

    <div id="slideMount" style="width:100%; display:flex; flex-direction:column; align-items:center; gap:18px;"></div>
    <canvas id="drawCanvas"></canvas>
  </main>

  <footer class="toolbar">
    <div class="toolbar-left">
      <button id="fullscreenBtn" class="tool-button square-active">‚§¢</button>
      <button id="prevBtn" class="tool-button disabled">‚Üê</button>
      <button id="nextBtn" class="tool-button">‚Üí</button>

      <button id="penBtn" class="tool-button circle">‚úèÔ∏è</button>
      <button id="greenBtn" class="tool-button circle">üü¢</button>
      <button id="redBtn" class="tool-button circle">üî¥</button>
      <button id="eraserBtn" class="tool-button circle">‚ö™</button>

      <button id="penSizeBtn" class="pill-button pill-blue">Pen size: Medium ‚ñæ</button>
      <button id="eraserSizeBtn" class="pill-button pill-blue">Eraser size: Medium ‚ñæ</button>
      <button id="clearBtn" class="pill-button pill-red">Clear</button>
    </div>

    <div class="toolbar-spacer"></div>

    <div class="toolbar-right">
      <button class="pill-button pill-purple">Animations: On</button>
      <button class="pill-button pill-purple">Timers: On</button>
      <button class="pill-button pill-green"><span class="icon">üñ®</span>Print</button>
    </div>
  </footer>

  <script>
    const slideMount = document.getElementById('slideMount');
    const slideSelect = document.getElementById('slideSelect');
    const pageInfo = document.getElementById('pageInfo');

    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    const timerWidget = document.getElementById('timerWidget');
    const timerDisplay = document.getElementById('timerDisplay');
    const timerStartBtn = document.getElementById('timerStart');
    const timerPauseBtn = document.getElementById('timerPause');
    const timerResetBtn = document.getElementById('timerReset');
    const timerMinInput = document.getElementById('timerMin');
    const timerSecInput = document.getElementById('timerSec');

    function renderRowQuestions(items, opts = { forceCount: null }) {
      const rows = [...items];

      if (typeof opts.forceCount === "number") {
        while (rows.length < opts.forceCount) rows.push({ label: "", mainHtml: "", subs: [], placeholder: true });
        if (rows.length > opts.forceCount) rows.length = opts.forceCount;
      }

      return `
        <section class="questions-rows">
          ${rows.map(r => `
            <div class="q-row ${r.placeholder ? "placeholder" : ""}">
              <span class="q-label">${r.label || ""}</span>
              <div class="q-content">
                <div class="q-main"><span class="math">${r.mainHtml || ""}</span></div>
                ${(r.subs || []).map(s => `
                  <div class="q-sub"><span class="math" style="font-size:34px;">${s}</span></div>
                `).join("")}
              </div>
            </div>
          `).join("")}
        </section>
      `;
    }

    function renderColumnQuestions(items, opts = { forceCount: null, columns: 2 }) {
      const rows = [...items];

      if (typeof opts.forceCount === "number") {
        while (rows.length < opts.forceCount) rows.push({ label: "", mainHtml: "", subs: [], placeholder: true });
        if (rows.length > opts.forceCount) rows.length = opts.forceCount;
      }

      const colCount = Math.min(opts.columns || 2, Math.max(1, rows.length));

      return `
        <section class="questions-cols" style="grid-template-columns: repeat(${colCount}, 1fr);">
          ${rows.map(r => `
            <div class="q-col ${r.placeholder ? "placeholder" : ""}">
              <span class="q-label">${r.label || ""}</span>
              <div class="q-content">
                <div class="q-main"><span class="math">${r.mainHtml || ""}</span></div>
                ${(r.subs || []).map(s => `
                  <div class="q-sub"><span class="math" style="font-size:34px;">${s}</span></div>
                `).join("")}
              </div>
            </div>
          `).join("")}
        </section>
      `;
    }

    function renderMiniWhiteboard(items) {
      const first4 = items.slice(0, 4);
      return `
        <section class="questions-grid">
          ${first4.map(r => `
            <div class="q-block">
              <span class="q-label">${r.label}</span>
              <span class="math">${r.exprHtml}</span>
            </div>
          `).join("")}
        </section>
      `;
    }

    // ------------------------------------------------------------
    // IMPORTANT CHANGE YOU REQUESTED:
    // All worked-example blue LaTeX coloring (\color{#1f7ed0}{...})
    // has been removed/replaced with black in the slides below.
    // ------------------------------------------------------------
    const slides = [
      {
        timer: null,
        render: () => `
          <section class="card">
            <h1>Core Knowledge: Changing the Subject</h1>
            <ul class="bullets">
              <li>To change the subject of an equation, the required variable must be isolated.</li>
              <li>Use the inverse (opposite) operation to eliminate terms.</li>
              <li>Any operation applied to one side of an equation must also be applied to the other side.</li>
            </ul>
          </section>

          <section class="card example-card">
            <h1>Example</h1>
            <p>Make \\(a\\) the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              {
                label: "a)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  a+2 &= b \\\\
                  \\phantom{a+}-2 &\\phantom{=} -2 \\\\
                  a &= b-2
                  \\end{aligned}
                  \\)
                `
              },
              {
                label: "b)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  a+5 &= b+7 \\\\
                  \\phantom{a+}-5 &\\phantom{=}\\phantom{b+}-5 \\\\
                  a &= b+2
                  \\end{aligned}
                  \\)
                `
              }
            ],
            { forceCount: 2, columns: 2 }
          )}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card example-card">
            <h1>Examples</h1>
            <p>Make a the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              { label: "a)", mainHtml: `\\(a+3=d\\)` },
              { label: "b)", mainHtml: `\\(a+4=x-2\\)` },
            ],
            { forceCount: 2, columns: 2 }
          )}
        `
      },

      {
        timer: { min: 1, sec: 0 },
        render: () => `
          <section class="card example-card">
            <h1>Question 1</h1>
            <p><strong>On your whiteboards, make \\(a\\) the subject.</strong></p>
          </section>

          ${renderMiniWhiteboard([
            { label: "a)", exprHtml: `\\(a+5=y\\)` },
            { label: "b)", exprHtml: `\\(a+1=b+4\\)` },
            { label: "c)", exprHtml: `\\(a+6=x-3\\)` },
            { label: "d)", exprHtml: `\\(a+9=p+2\\)` }
          ])}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card">
            <h1>Core Knowledge: Subtraction</h1>
            <ul class="bullets">
              <li>When an equation contains subtraction, use the inverse operation (addition).</li>
              <li>Add the same value to both sides of the equation.</li>
              <li>The aim is to isolate the required variable.</li>
            </ul>
          </section>

          <section class="card example-card">
            <h1>Example</h1>
            <p>Make \\(a\\) the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              {
                label: "a)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                    a-4 &= b \\\\
                    \\phantom{a}+4 &\\phantom{=} +4 \\\\
                    a &= b+4
                  \\end{aligned}
                  \\)
                `
              },
              {
                label: "b)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  a-7 &= b-1 \\\\
                  \\phantom{a}+7 &\\phantom{=}\\phantom{b-}+7 \\\\
                  a &= b+6
                  \\end{aligned}
                  \\)
                `
              }
            ],
            { forceCount: 2, columns: 2 }
          )}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card example-card">
            <h1>Examples</h1>
            <p>Make a the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              { label: "a)", mainHtml: `\\(a-3=b\\)` },
              { label: "b)", mainHtml: `\\(a-5=c+2\\)` },
              { label: "", mainHtml: "", placeholder: true }
            ],
            { forceCount: 4, columns: 2 }
          )}
        `
      },

      {
        timer: { min: 1, sec: 0 },
        render: () => `
          <section class="card example-card">
            <h1>Question 2</h1>
            <p><strong>On your whiteboards, make \\(a\\) the subject.</strong></p>
          </section>

          ${renderMiniWhiteboard([
            { label: "a)", exprHtml: `\\(a-6=y\\)` },
            { label: "b)", exprHtml: `\\(a-2=b+5\\)` },
            { label: "c)", exprHtml: `\\(a-9=x-4\\)` },
            { label: "d)", exprHtml: `\\(a-1=p+7\\)` }
          ])}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card">
            <h1>Core Knowledge: Multiplication</h1>
            <ul class="bullets">
              <li>When a variable is multiplied by a number, use the inverse operation (division).</li>
              <li>Divide both sides of the equation by the same non-zero number.</li>
              <li>The goal is to isolate the variable.</li>
            </ul>
          </section>

          <section class="card example-card">
            <h1>Example</h1>
            <p>Make \\(a\\) the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              {
                label: "a)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  \\frac{3a}{3} &= \\frac{b}{3} \\\\
                  a &= \\frac{b}{3}
                  \\end{aligned}
                  \\)
                `
              },
              {
                label: "b)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  \\frac{7a}{7} &= \\frac{x-2}{7} \\\\
                  a &= \\frac{x-2}{7}
                  \\end{aligned}
                  \\)
                `
              }
            ],
            { forceCount: 2, columns: 2 }
          )}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card example-card">
            <h1>Examples</h1>
            <p>Make the stated variable the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              { label: "a)", mainHtml: `\\(5a=c\\)` },
              { label: "b)", mainHtml: `\\(4a=b+8\\)` },
              { label: "", mainHtml: "", placeholder: true }
            ],
            { forceCount: 4, columns: 2 }
          )}
        `
      },

      {
        timer: { min: 1, sec: 0 },
        render: () => `
          <section class="card example-card">
            <h1>Question 3</h1>
            <p><strong>On your whiteboards, make \\(a\\) the subject.</strong></p>
          </section>

          ${renderMiniWhiteboard([
            { label: "a)", exprHtml: `\\(2a=y\\)` },
            { label: "b)", exprHtml: `\\(6a=b+12\\)` },
            { label: "c)", exprHtml: `\\(9a=x\\)` },
            { label: "d)", exprHtml: `\\(4a=p+20\\)` }
          ])}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card">
            <h1>Core Knowledge: Division</h1>
            <ul class="bullets">
              <li>When a variable is divided by a number, use the inverse operation (multiplication).</li>
              <li>Multiply both sides of the equation by the same number.</li>
              <li>Ensure the variable is fully isolated.</li>
            </ul>
          </section>

          <section class="card example-card">
            <h1>Example</h1>
            <p>Make \\(a\\) the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              {
                label: "a)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  \\frac{a}{5} &= b \\\\
                  \\phantom{a\\div}\\times 5 &\\phantom{=} \\times 5 \\\\
                  a &= 5b
                  \\end{aligned}
                  \\)
                `
              },
              {
                label: "b)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                  \\frac{a}{3} &= x-5 \\\\
                  \\phantom{a\\div}\\times 3 &\\phantom{=} \\times 3 \\\\
                  a &= 3(x-5) \\\\
                  a &= 3x-15
                  \\end{aligned}
                  \\)
                `
              }
            ],
            { forceCount: 2, columns: 2 }
          )}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card example-card">
            <h1>Examples</h1>
            <p>Make the stated variable the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              { label: "a)", mainHtml: `\\(\\frac{a}{4}=c\\)` },
              { label: "b)", mainHtml: `\\(\\frac{a}{6}=b+1\\)` },
            ],
            { forceCount: 4, columns: 2 }
          )}
        `
      },

      {
        timer: { min: 1, sec: 0 },
        render: () => `
          <section class="card example-card">
            <h1>Question 4</h1>
            <p><strong>On your whiteboards, make \\(a\\) the subject.</strong></p>
          </section>

          ${renderMiniWhiteboard([
            { label: "a)", exprHtml: `\\(\\frac{a}{2}=y\\)` },
            { label: "b)", exprHtml: `\\(\\frac{a}{5}=b+3\\)` },
            { label: "c)", exprHtml: `\\(\\frac{a}{8}=x\\)` },
            { label: "d)", exprHtml: `\\(\\frac{a}{10}=p+4\\)` },
          ])}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card">
            <h1>Core Knowledge: Changing the Subject</h1>
            <p>
              When changing the subject of an equation, undo the operations in reverse order.
              Start with the operation furthest away from the variable and treat anything in
              brackets or a fraction as one whole expression. Work step by step until the
              variable is on its own.
            </p>
          </section>

          <section class="card example-card">
            <h1>Example</h1>
            <p>Make \\(x\\) the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              {
                label: "a)",
                mainHtml: `
                  \\(
                  \\begin{aligned}[t]
                    \\frac{3x+4}{2} &= 7 \\\\
                    \\times 2 &\\phantom{=} \\times 2 \\\\
                    3x+4 &= 14 \\\\
                    -4 &\\phantom{=} -4 \\\\
                    3x &= 10 \\\\
                    \\div 3 &\\phantom{=} \\div 3 \\\\
                    x &= \\frac{10}{3}
                  \\end{aligned}
                  \\)
                `
              }
            ],
            { forceCount: 1, columns: 1 }
          )}
        `
      },

      {
        timer: null,
        render: () => `
          <section class="card example-card">
            <h1>Examples</h1>
            <p>Make t the subject.</p>
          </section>

          ${renderColumnQuestions(
            [
              { label: "a)", mainHtml: `\\(\\frac{5t-1}{3}=6\\)` },
              { label: "b)", mainHtml: `\\(y=m+ct\\)` },
            ],
            { forceCount: 4, columns: 2 }
          )}
        `
      },

      {
        timer: { min: 1, sec: 0 },
        render: () => `
          <section class="card example-card">
            <h1>Question</h1>
            <p><strong>On your whiteboards, make \\(x\\) the subject.</strong></p>
          </section>

          ${renderMiniWhiteboard([
            { label: "a)", exprHtml: `\\(\\frac{4x+5}{2}=11\\)` },
            { label: "b)", exprHtml: `\\(y=3x+7\\)` },
            { label: "c)", exprHtml: `\\(\\frac{7x-3}{5}=8\\)` },
            { label: "d)", exprHtml: `\\(p=6x-4\\)` }
          ])}
        `
      },

      {
        timer: { min: 20, sec: 0 },
        render: () => `
          <div class="review-title">üìù Core Knowledge Review - Write in your books:</div>

          <div class="review-box">
            <strong>Changing the subject - with one operation</strong><br>
            Change the subject by applying the same operation to both sides.

            <div style="
              margin-top: 12px;
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              gap: 12px;
              text-align: center;
              font-family: 'Times New Roman', Times, serif;
              font-size: 18px;
              font-weight: 700;
            ">
              <div>
                Example 1
                <div style="margin-top:6px;">
                  \\(
                  \\begin{aligned}
                  a+2 &= b \\\\
                  \\phantom{a+}-2 &\\phantom{=} -2 \\\\
                  a &= b-2
                  \\end{aligned}
                  \\)
                </div>
              </div>

              <div>
                Example 2
                <div style="margin-top:6px;">
                  \\(
                  \\begin{aligned}
                  a-4 &= b \\\\
                  \\phantom{a-}+4 &\\phantom{=} +4 \\\\
                  a &= b+4
                  \\end{aligned}
                  \\)
                </div>
              </div>

              <div>
                Example 3
                <div style="margin-top:6px;">
                  \\(
                  \\begin{aligned}
                  3a &= b \\\\
                  \\frac{3a}{3} &= \\frac{b}{3} \\\\
                  a &= \\frac{b}{3}
                  \\end{aligned}
                  \\)
                </div>
              </div>

              <div>
                Example 4
                <div style="margin-top:6px;">
                  \\(
                  \\begin{aligned}
                  \\frac{a}{5} &= b \\\\
                  \\phantom{\\frac{a}{}}\\times 5 &\\phantom{=} \\times 5 \\\\
                  a &= 5b
                  \\end{aligned}
                  \\)
                </div>
              </div>
            </div>
          </div>

          <div class="review-box">
            <strong>Changing the Subject - with many operations</strong><br>
            When changing the subject of an equation, undo the operations in reverse order.
            Start with the operation furthest away from the variable and treat anything in
            brackets or a fraction as one whole expression. Work step by step until the
            variable is on its own.

            <div class="review-example" style="margin-top:10px; font-size:22px;">
              \\(
              \\begin{aligned}
              \\frac{3x+4}{2} &= 7 \\\\
              \\phantom{\\frac{3x+4}{}}\\times 2 &\\phantom{=} \\times 2 \\\\
              3x+4 &= 14 \\\\
              \\phantom{3x+} -4 &\\phantom{=} -4 \\\\
              3x &= 10 \\\\
              \\frac{3x}{3} &= \\frac{10}{3} \\\\
              x &= \\frac{10}{3}
              \\end{aligned}
              \\)
            </div>
          </div>

          <div class="apply-task">
            <h2>Independent Apply Task</h2>
            <p>Complete all questions on the worksheet showing all working out.</p>
          </div>
        `
      }
    ];

    const maxSlide = slides.length - 1;
    let currentSlide = 0;

    function buildDropdown() {
      slideSelect.innerHTML = "";
      slides.forEach((_, i) => {
        const opt = document.createElement("option");
        opt.value = String(i);
        opt.textContent = `Slide ${i + 1}`;
        slideSelect.appendChild(opt);
      });
    }
    buildDropdown();

    function updateNavUI() {
      prevBtn.classList.toggle('disabled', currentSlide === 0);
      nextBtn.classList.toggle('disabled', currentSlide === maxSlide);
      pageInfo.textContent = `Slide ${currentSlide + 1} of ${maxSlide + 1}`;
      slideSelect.value = String(currentSlide);
    }

    function renderSlide() {
      const t = slides[currentSlide].timer;
      if (t) {
        timerWidget.classList.remove('hidden');
        setTimerTo(t.min, t.sec);
      } else {
        timerWidget.classList.add('hidden');
        pauseTimer();
      }

      slideMount.innerHTML = slides[currentSlide].render();
      if (window.MathJax?.typesetPromise) MathJax.typesetPromise();
      updateNavUI();
      resizeCanvas();
      restoreDrawingForSlide(currentSlide);
    }

    function changeSlideTo(target) {
      if (target < 0 || target > maxSlide) return;
      saveCurrentSlideDrawing();
      currentSlide = target;
      renderSlide();
    }

    prevBtn.addEventListener('click', () => changeSlideTo(currentSlide - 1));
    nextBtn.addEventListener('click', () => changeSlideTo(currentSlide + 1));
    slideSelect.addEventListener('change', (e) => changeSlideTo(parseInt(e.target.value, 10) || 0));

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') { e.preventDefault(); changeSlideTo(currentSlide - 1); }
      if (e.key === 'ArrowRight') { e.preventDefault(); changeSlideTo(currentSlide + 1); }
    });

    const canvas = document.getElementById('drawCanvas');
    const contentEl = document.querySelector('.content');
    const ctx = canvas.getContext('2d');

    const penBtn = document.getElementById('penBtn');
    const greenBtn = document.getElementById('greenBtn');
    const redBtn = document.getElementById('redBtn');
    const eraserBtn = document.getElementById('eraserBtn');

    const penSizeBtn = document.getElementById('penSizeBtn');
    const eraserSizeBtn = document.getElementById('eraserSizeBtn');
    const clearBtn = document.getElementById('clearBtn');

    let drawingEnabled = false;
    let isDrawing = false;
    let currentTool = 'pen';
    let currentColor = '#111111';

    const slideDrawings = new Array(slides.length).fill(null);

    const penSizes = [
      { label: 'Small', value: 2 },
      { label: 'Medium', value: 4 },
      { label: 'Large', value: 8 }
    ];
    const eraserSizes = [
      { label: 'Small', value: 10 },
      { label: 'Medium', value: 20 },
      { label: 'Large', value: 40 }
    ];
    let penSizeIndex = 1;
    let eraserSizeIndex = 1;

    function currentPenSize() { return penSizes[penSizeIndex].value; }
    function currentEraserSize() { return eraserSizes[eraserSizeIndex].value; }

    function updateSizeLabels() {
      penSizeBtn.textContent = `Pen size: ${penSizes[penSizeIndex].label} ‚ñæ`;
      eraserSizeBtn.textContent = `Eraser size: ${eraserSizes[eraserSizeIndex].label} ‚ñæ`;
    }
    updateSizeLabels();

    function enableDrawing(enable) {
      drawingEnabled = enable;
      canvas.style.pointerEvents = enable ? 'auto' : 'none';
    }

    function setActiveToolButton(btn) {
      [penBtn, greenBtn, redBtn, eraserBtn].forEach(b => b.classList.remove('active'));
      if (btn) btn.classList.add('active');
    }

    penBtn.addEventListener('click', () => {
      currentTool = 'pen';
      currentColor = '#111111';
      enableDrawing(true);
      setActiveToolButton(penBtn);
    });

    greenBtn.addEventListener('click', () => {
      currentTool = 'pen';
      currentColor = '#2ecc71';
      enableDrawing(true);
      setActiveToolButton(greenBtn);
    });

    redBtn.addEventListener('click', () => {
      currentTool = 'pen';
      currentColor = '#e74c3c';
      enableDrawing(true);
      setActiveToolButton(redBtn);
    });

    eraserBtn.addEventListener('click', () => {
      currentTool = 'eraser';
      enableDrawing(true);
      setActiveToolButton(eraserBtn);
    });

    penSizeBtn.addEventListener('click', () => {
      penSizeIndex = (penSizeIndex + 1) % penSizes.length;
      updateSizeLabels();
    });

    eraserSizeBtn.addEventListener('click', () => {
      eraserSizeIndex = (eraserSizeIndex + 1) % eraserSizes.length;
      updateSizeLabels();
    });

    clearBtn.addEventListener('click', () => {
      clearCanvas();
      slideDrawings[currentSlide] = null;
    });

    function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    function saveCurrentSlideDrawing() {
      slideDrawings[currentSlide] = canvas.toDataURL('image/png');
    }

    function restoreDrawingForSlide(index) {
      ctx.globalCompositeOperation = 'source-over';
      clearCanvas();
      const dataUrl = slideDrawings[index];
      if (!dataUrl) return;
      const img = new Image();
      img.onload = () => {
        ctx.globalCompositeOperation = 'source-over';
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      };
      img.src = dataUrl;
    }

    function resizeCanvas() {
      const rect = contentEl.getBoundingClientRect();
      canvas.width = rect.width;
      canvas.height = rect.height;
      restoreDrawingForSlide(currentSlide);
    }
    window.addEventListener('resize', resizeCanvas);

    function startDraw(x, y) {
      if (!drawingEnabled) return;
      isDrawing = true;
      ctx.beginPath();
      ctx.moveTo(x, y);
    }

    function drawLine(x, y) {
      if (!isDrawing) return;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      if (currentTool === 'eraser') {
        ctx.globalCompositeOperation = 'destination-out';
        ctx.lineWidth = currentEraserSize();
      } else {
        ctx.globalCompositeOperation = 'source-over';
        ctx.strokeStyle = currentColor;
        ctx.lineWidth = currentPenSize();
      }
      ctx.lineTo(x, y);
      ctx.stroke();
    }

    function stopDraw() {
      if (!isDrawing) return;
      isDrawing = false;
      ctx.closePath();
      saveCurrentSlideDrawing();
    }

    canvas.addEventListener('mousedown', (e) => {
      const rect = canvas.getBoundingClientRect();
      startDraw(e.clientX - rect.left, e.clientY - rect.top);
    });
    canvas.addEventListener('mousemove', (e) => {
      const rect = canvas.getBoundingClientRect();
      drawLine(e.clientX - rect.left, e.clientY - rect.top);
    });
    canvas.addEventListener('mouseup', stopDraw);
    canvas.addEventListener('mouseleave', stopDraw);

    canvas.addEventListener('touchstart', (e) => {
      const touch = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      startDraw(touch.clientX - rect.left, touch.clientY - rect.top);
      e.preventDefault();
    }, { passive: false });

    canvas.addEventListener('touchmove', (e) => {
      const touch = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      drawLine(touch.clientX - rect.left, touch.clientY - rect.top);
      e.preventDefault();
    }, { passive: false });

    canvas.addEventListener('touchend', stopDraw);
    canvas.addEventListener('touchcancel', stopDraw);

    let timerInterval = null;
    let timerRemainingSeconds = 60;
    let timerSetSeconds = 60;

    function clamp(num, min, max) { return Math.min(max, Math.max(min, num)); }
    function pad2(n) { return String(n).padStart(2, '0'); }

    function renderTimer() {
      const m = Math.floor(timerRemainingSeconds / 60);
      const s = timerRemainingSeconds % 60;
      timerDisplay.textContent = `${pad2(m)}:${pad2(s)}`;
    }

    function readInputsAsSeconds() {
      const min = clamp(parseInt(timerMinInput.value, 10) || 0, 0, 999);
      const sec = clamp(parseInt(timerSecInput.value, 10) || 0, 0, 59);
      timerMinInput.value = String(min);
      timerSecInput.value = String(sec);
      return (min * 60) + sec;
    }

    function stopTimerInterval() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function startTimer() {
      const inputSeconds = readInputsAsSeconds();
      const shouldUseInputs =
        timerRemainingSeconds === 0 ||
        timerRemainingSeconds === timerSetSeconds;

      if (shouldUseInputs) {
        timerSetSeconds = inputSeconds || 0;
        timerRemainingSeconds = timerSetSeconds;
      }

      stopTimerInterval();
      timerInterval = setInterval(() => {
        if (timerRemainingSeconds > 0) {
          timerRemainingSeconds -= 1;
          renderTimer();
        } else {
          stopTimerInterval();
        }
      }, 1000);

      renderTimer();
    }

    function pauseTimer() { stopTimerInterval(); }

    function resetTimer() {
      stopTimerInterval();
      timerRemainingSeconds = timerSetSeconds;
      timerMinInput.value = String(Math.floor(timerSetSeconds / 60));
      timerSecInput.value = String(timerSetSeconds % 60);
      renderTimer();
    }

    function setTimerTo(min, sec) {
      stopTimerInterval();
      min = clamp(parseInt(min, 10) || 0, 0, 999);
      sec = clamp(parseInt(sec, 10) || 0, 0, 59);

      timerMinInput.value = String(min);
      timerSecInput.value = String(sec);

      timerSetSeconds = (min * 60) + sec;
      timerRemainingSeconds = timerSetSeconds;
      renderTimer();
    }

    timerStartBtn.addEventListener('click', startTimer);
    timerPauseBtn.addEventListener('click', pauseTimer);
    timerResetBtn.addEventListener('click', resetTimer);

    function onInputsChanged() {
      const secs = readInputsAsSeconds();
      timerSetSeconds = secs;
      if (!timerInterval) {
        timerRemainingSeconds = timerSetSeconds;
        renderTimer();
      }
    }
    timerMinInput.addEventListener('input', onInputsChanged);
    timerSecInput.addEventListener('input', onInputsChanged);
    timerMinInput.addEventListener('change', onInputsChanged);
    timerSecInput.addEventListener('change', onInputsChanged);

    renderTimer();

    const TIMER_POS_KEY = 'timerWidgetPosition_v3';

    function loadTimerPosition() {
      try {
        const raw = localStorage.getItem(TIMER_POS_KEY);
        if (!raw) return;
        const pos = JSON.parse(raw);
        if (typeof pos?.left !== 'number' || typeof pos?.top !== 'number') return;
        timerWidget.style.left = `${pos.left}px`;
        timerWidget.style.top = `${pos.top}px`;
      } catch {}
    }

    function saveTimerPosition(left, top) {
      localStorage.setItem(TIMER_POS_KEY, JSON.stringify({ left, top }));
    }

    function makeDraggableAbsolute(el, onSave) {
      let dragging = false;
      let offsetX = 0;
      let offsetY = 0;

      el.addEventListener('mousedown', (e) => {
        const tag = e.target.tagName.toLowerCase();
        if (tag === 'input' || tag === 'button') return;

        dragging = true;
        const rect = el.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
        e.preventDefault();
      });

      window.addEventListener('mousemove', (e) => {
        if (!dragging) return;
        const parentRect = contentEl.getBoundingClientRect();

        let left = e.clientX - parentRect.left - offsetX;
        let top = e.clientY - parentRect.top - offsetY;

        left = clamp(left, 0, parentRect.width - el.offsetWidth);
        top = clamp(top, 0, parentRect.height - el.offsetHeight);

        el.style.left = `${left}px`;
        el.style.top = `${top}px`;
      });

      window.addEventListener('mouseup', () => {
        if (!dragging) return;
        dragging = false;
        const left = parseFloat(el.style.left) || 0;
        const top = parseFloat(el.style.top) || 0;
        if (onSave) onSave(left, top);
      });
    }

    loadTimerPosition();
    makeDraggableAbsolute(timerWidget, saveTimerPosition);

    renderSlide();
  </script>
</body>
</html>

